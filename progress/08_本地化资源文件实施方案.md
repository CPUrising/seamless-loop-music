# 技术方案：本地化 (Localization) 实施指南 —— 资源文件法

**日期**：2026-02-10  
**提案人**：Lev Zenith  
**目标**：移除代码中的硬编码字符串，使用标准的 .NET 资源文件 (.resx) 实现多语言切换。

## 1. 核心变更 (Core Changes)

### 1.1 存储方式
- **现状 (Old)**: 硬编码在 C# `MainWindow.xaml.cs` 中 (`btnPlay.Content = "播放"` 或 `if(lang=="cn")...`)。
- **目标 (New)**: 
  - `Properties/Resources.resx` (默认/英文资源)
  - `Properties/Resources.zh-CN.resx` (简体中文资源)

### 1.2 绑定方式
- **现状 (Old)**: 手动赋值 UI 控件的内容。
- **目标 (New)**: XAML 静态绑定 (`{x:Static p:Resources.KeyName}`)，让 WPF 自动读取资源。

## 2. 实施步骤 (Manual Implementation Steps)

> **注意**：以下步骤建议在 Visual Studio IDE 中通过界面操作完成，无需编写复杂命令。

### 2.1 创建资源文件
1. 建议清理现有的多余资源文件（如果有）。
2. 在 **Solution Explorer** (解决方案资源管理器) 中右键项目 -> **Properties** (属性) -> **Resources** (资源)。
3. 点击“创建或打开程序集资源”。
4. 这会自动生成 `Resources.resx` (默认)。
5. 手动复制该文件为 `Resources.zh-CN.resx`。

### 2.2 填写翻译对照表
在生成的表格视图中，添加如下键值对 (示例)：

| 名称 (Name) | 值 (Value) - Resources.resx | 值 (Value) - Resources.zh-CN.resx |
| :--- | :--- | :--- |
| **AppTitle** | Seamless Loop Music Player | 无缝循环音乐播放器 |
| **Play** | Play | 播放 |
| **Pause** | Pause | 暂停 |
| **SmartMatch** | Smart Match | 智能匹配 |
| **MyPlaylist** | My Playlist | 我的歌单 |
| **...** | ... | ... |

*(需遍历 UI 所有文本进行添加)*

### 2.3 修改 XAML 绑定
1. 在 `MainWindow.xaml` 顶部引入命名空间：
   ```xml
   xmlns:p="clr-namespace:seamless_loop_music.Properties"
   ```
2. 将硬编码文本替换为绑定：
   ```xml
   <!-- Old -->
   <Button Content="播放" ... />
   
   <!-- New -->
   <Button Content="{x:Static p:Resources.Play}" ... />
   ```

### 2.4 代码切换逻辑
在 `btnSwitchLang_Click` 事件中：
```csharp
// 切换语言
var culture = new System.Globalization.CultureInfo("zh-CN"); // 或 "en-US"
seamless_loop_music.Properties.Resources.Culture = culture;

// 提示重启或尝试刷新界面
MessageBox.Show("Language switched! Please restart application to apply completely.");
```

## 3. 预期收益 (Benefits)

1.  **代码解耦**: 界面逻辑 (C#) 和文本内容 (String) 分离，代码更干净。
2.  **维护方便**: 改错别字只需改资源文件，不用动代码。
3.  **扩展性**: 未来如果要加日语，只需复制一个 `Resources.ja-JP.resx` 并翻译即可，无需修改任何代码。

---
*Created by Lev Zenith for cpu*
